@startuml ATM_Service_StateMachine
skinparam monochrome true
skinparam shadowing false
skinparam dpi 150

[*] --> NoAccess

state NoAccess {
  [*] --> Idle : Нет доступа
  Idle --> CardAndPIN : Карта инкассатора (16 цифр) + PIN
}

state CardAndPIN {
  CardAndPIN --> ServiceMenu : Аутентификация успешна
}

state ServiceMenu {
  [*] --> Available
  Available --> Replenish : 1. Пополнение наличными
  Available --> Collect : 2. Изъятие наличных
  Available --> ReplaceCassette : 3. Замена кассеты
  Replenish --> Available : Завершено
  Collect --> Available : Завершено
  ReplaceCassette --> Available : Завершено
}

state ServiceEnding {
  [*] --> Logout : 4. Exit
  Logout --> NoAccess : Выход
}

ServiceMenu --> ServiceEnding : 4. Exit

note right of CardAndPIN
  В реализации: карта 1000000000000001, PIN 1111
end note

note right of ServiceMenu
  Операции с CashInventory,
  сохранение в atm_state.json
end note

@enduml
